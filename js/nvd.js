function log(message){console.log(message)}function appendTobody(markup){$("body").append("<pre>"+markup+"</pre>")}function showfKeyHints(){log("trying to show fkey hints");var thisElement=$(this),formData={classname:thisElement.data("classname"),fieldname:thisElement.data("fieldname"),currentValue:thisElement.val()};$.post("ajaxHandlers/foreignKeyHandler.php",formData,function(response){var parentDiv=thisElement.parent();parentDiv.find(".fkeyHints").remove(),parentDiv.css("position","relative").append(response);var fkeyHints=thisElement.siblings(".fkeyHints");fkeyHints.find(".list-group-item").click(function(){var hint=$(this);if(thisElement.parent().hasClass("inputForEditable"))return thisElement.val(hint.data("value")),thisElement.attr("autofocus","true"),fkeyHints.hide(),!1;var hiddenIpId=thisElement.attr("id")+"Ip";thisElement.after("<input id='"+hiddenIpId+"' type='hidden' name='"+thisElement.attr("name")+"' value='"+hint.data("value")+"'/>"),fkeyHints.hide();var href=hint.attr("href"),exLink="<a href='"+href+"' target='_blank'>"+hint.data("value")+" ("+hint.find(".list-group-item-heading").html()+")</a>",resetBtn="<a href='#' class='danger_link pull-right resetBtn'>"+btsp.icon("remove")+"</a>",exlinkWraper=$("<p class='exlink form-control'>"+exLink+" "+resetBtn+"</p>");return thisElement.after(exlinkWraper),thisElement.hide(),exlinkWraper.find(".resetBtn").click(function(){return exlinkWraper.remove(),thisElement.show(),fkeyHints.show(),$("#"+hiddenIpId).remove(),thisElement.keyup(showfKeyHints),!1}),!1})})}$(function(){setInterval(function(){$(".session_msg").fadeOut("slow")},7e3),$(".session_msg").click(function(){$(this).fadeOut("slow")}),setInterval(function(){$(".autoFadeOut").fadeOut("slow")},2e3),$(".autoFadeOut").click(function(){$(this).fadeOut("slow")}),$("a.danger_link").click(function(){return confirm("Are you sure?")}),$(".table").tablesorter().find("th").css({cursor:"pointer"})}),!function($){$.fn.getCss=function(cssProp){var value=this.css(cssProp);return value=value.replace(/px/,"")}}(jQuery);var btsp={icon:function(icon){return"<span class='glyphicon glyphicon-"+icon+" '></span>"},showModal:function(options){var markup="<div id='"+options.id+"' class='modal fade'>";markup+="<div class='modal-dialog'>",markup+="<div class='modal-content'>",markup+="<button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>",options.content?markup+=options.content:(markup+="<div class='modal-header'>",markup+="<h4 class='modal-title'>"+options.title+"</h4>",markup+="</div>",markup+="<div class='modal-body'>",markup+=options.body,markup+="</div>",markup+="<div class='modal-footer'>",markup+="<button type='button' class='btn btn-default' data-dismiss='modal'>No</button>",markup+="<button id='confirmNewRecord' type='button' class='btn btn-primary'>Yes</button>",markup+="</div>",markup+="</div>"),markup+="</div>",markup+="</div>",$("body").append(markup),options.show=!0,$("#"+options.id).modal(options)},waiting:function(){return"<div class='progress progress-striped active'><div class='progress-bar'  role='progressbar' aria-valuenow='100' aria-valuemin='0' aria-valuemax='100' style='width: 100%'></div></div>"}},print=function(message){var $output=$('<div class="nvd-print-result"><div>');$output.append("<p>"+message+"</p>"),$output.css({position:"fixed",bottom:"1em",left:"1em",padding:"1em",border:"1px solid #333",backgroundColor:"rgba(50,50,50,0.5)",borderRadius:"0.5em"}),$output.appendTo("body")};!function($){$.fn.highlight=function(){this.css("border","2px solid red"),this.css("background-color","#fdd")}}(jQuery),$(function(){$(".fkeyInput").keyup(showfKeyHints)}),$(function(){var form=$("#paginationForm"),input=$("#res_per_page"),disableActiveLinks=$(".pagination .active,.pagination .disabled");input.change(function(){form.submit()}),disableActiveLinks.click(function(){return!1})}),$(function(){function getValue(jqObj){return jqObj.data("value")}function setInputValue(inputElement,value){var type=inputElement.data("type");switch(type){case"textarea":inputElement.text(value);break;case"select":inputElement.find("option").each(function(index,element){$(element).text()==value&&$(element).attr("selected","true")});break;default:inputElement.val(value)}}function editableClickHandler(){var $thisEditable=$(this),inputContainerId=$thisEditable.attr("id")+"-input",$inputContainer=$("#"+inputContainerId).clone(),$newInput=$inputContainer.find(".form-control"),value=getValue($thisEditable);$inputContainer.css("position","absolute"),$inputContainer.css("z-index","1"),$thisEditable.css("position","relative"),$newInput.attr("id",inputContainerId+"-edit"),$thisEditable.replaceWith($inputContainer),setInputValue($newInput,value),$inputContainer.width($newInput.parent().width()),$newInput.focus(),$(".fkeyInput").keyup(showfKeyHints),$newInput.keypress(function(e){return 13==e.keyCode?!1:void 0}),$newInput.bind("keyup",function(e){if(13==e.keyCode){var newValue=$newInput.val(),$waiting=$(btsp.waiting());$inputContainer.replaceWith($waiting);var data={recordInfo:$thisEditable.data("cell-id"),valueToSave:newValue};$.post("html_components/records_post_handler.php",data,function(response){$(response).hasClass("alert-success")&&$thisEditable.text(newValue),$waiting.replaceWith($thisEditable),$("body").append(response)})}else 27==e.keyCode&&$inputContainer.replaceWith($thisEditable)}),$inputContainer.bind("blur",function(){$inputContainer.replaceWith($thisEditable)}),$editable.click(editableClickHandler)}var $editable=$(".editable");$editable.each(function(index,entry){var element=$(entry),$parent=element.parent();$parent.innerHeight()-$parent.getCss("padding-bottom")-$parent.getCss("padding-top"),$parent.width()-$parent.getCss("padding-left")-$parent.getCss("padding-right")}),$editable.click(editableClickHandler)}),$(function(){function lccHandler(){var thisCheckbox=$(this),parentForm=thisCheckbox.parents(".linkedClassForm"),data=parentForm.serialize(),$waiting=$(btsp.waiting());thisCheckbox.replaceWith($waiting),$.post("html_components/linkedClassCheckbox.php",data,function(response){$("body").append(response),$waiting.replaceWith(thisCheckbox)}),thisCheckbox.click(lccHandler)}$(".linkedClassCheckbox").click(lccHandler)}),$(function(){function liveFKeyHandler(){for(var thisElement=$(this),targetInputsList=thisElement.data("dependantfields").split(","),waiting=$(btsp.waiting()),i=0,len=targetInputsList.length;len>i;i++){var thisTarget=$("#"+targetInputsList[i]),data={parentField:thisElement.attr("id"),targetField:targetInputsList[i],parentFieldValue:thisElement.val(),classname:thisTarget.data("classname")};thisTarget.replaceWith(waiting),thisTarget.load("ajaxHandlers/liveFKeyHandler.php",data),waiting.replaceWith(thisTarget)}}var fKeyParentElements=$(".liveFKeyParent");fKeyParentElements.change(liveFKeyHandler),fKeyParentElements.each(liveFKeyHandler)}),$(function(){function setValues(){var classInputVal=classInput.val(),inputName=classInput.attr("id"),data="class_id"==inputName?{classId:classInputVal}:{"class":classInputVal};$.post("ajaxHandlers/classIdChangeHandler.php",data,function(res){var data=JSON.parse(res);for(var key in data)$("#"+key).val(data[key]);if(data.subjCombs&&""!=data.subjCombs.toString()){var markup="<select id='subj_combination' name='subj_combination' class='form-control'>";for(var subcomb in data.subjCombs)subcomb=data.subjCombs[subcomb],markup=markup+"<option value='"+subcomb.id.val+"'>"+subcomb.title.val+"</option>";markup+="</select>"}else markup="<input id='subj_combination' name='subj_combination' class='form-control'>";$("#subj_combination").replaceWith(markup)})}function performFunctions(){setValues()}var classInput=$("#class_id,#class");performFunctions(),classInput.change(function(){performFunctions()})}),$(function(){function updateStudentPhoto(){var $photo=$("#photoInput"),file=$photo.get(0).files[0],imageType=/image.*/;if(!file.type.match(imageType))return $("#response").html("Not a valid image file."),void 0;var img=document.createElement("img");img.classList.add("obj"),img.file=file,$(".photoThumb img").remove(),$(".photoThumb").get(0).appendChild(img);var reader=new FileReader;if(reader.onload=function(aImg){return function(e){aImg.src=e.target.result}}(img),reader.readAsDataURL(file),window.FormData){$photo.get(0);var formdata=new FormData;$("#response").html("Uploading . . ."),formdata.append("photoInput",file),formdata.append("person_id",$("#person_id").val()),$.ajax({url:"ajaxHandlers/photoUploader.php",type:"POST",data:formdata,processData:!1,contentType:!1,success:function(res){$("#response").html(res),$("#photo .error").remove()}})}}var $photo=$("#photoInput");$photo.change(updateStudentPhoto),$photo.css("display","none"),$(".photoThumb").click(function(evt){$photo.get(0).click(),evt.preventDefault()})}),$(function(){function beforePrint(){}function afterPrint(){}if(window.matchMedia){var mediaQueryList=window.matchMedia("print");mediaQueryList.addListener(function(mql){mql.matches?beforePrint():afterPrint()})}}),$(function(){var selectAllButtons=$(".selectAll");selectAllButtons.css("cursor","pointer"),selectAllButtons.click(function(){var targetClass=$(this).data("target-class"),targetElements=$("."+targetClass);targetElements.prop("checked")?targetElements.prop("checked",!1):targetElements.prop("checked",!0)})});